<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PilatesFlow - Turmas</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
    <style>
        /* Estilos específicos para a grade de turmas */
        .grade-container {
            overflow-x: auto;
            border-radius: 15px;
            box-shadow: var(--card-shadow);
            background: white;
        }

        .class-cell {
            min-width: 80px;
            height: 60px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            vertical-align: middle;
            font-weight: bold;
            font-size: 0.9rem;
            border: 1px solid #eee;
        }

        .class-cell:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 10;
        }

        /* Cores de ocupação */
        .status-low {
            background-color: #E8F5E9;
            color: #2E7D32;
            border-color: #C8E6C9;
        }

        /* 0-3 */
        .status-med {
            background-color: #FFF3E0;
            color: #EF6C00;
            border-color: #FFE0B2;
        }

        /* 4-5 */
        .status-full {
            background-color: #FFEBEE;
            color: #C62828;
            border-color: #FFCDD2;
        }

        /* 6 (Lotado) */

        /* Cabeçalho da tabela fixo */
        th.sticky-col {
            position: sticky;
            left: 0;
            background: white;
            z-index: 20;
            border-right: 2px solid #ddd;
        }

        /* Modal de Busca */
        .student-item {
            cursor: pointer;
            transition: background 0.2s;
        }

        .student-item:hover {
            background-color: #f8f9fa;
        }

        .student-item.disabled {
            opacity: 0.6;
            cursor: not-allowed;
            background-color: #eee;
        }
    </style>
</head>

<body class="bg-light">

    <nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow-sm mb-4">
        <div class="container">
            <a class="navbar-brand fw-bold" href="dashboard.html">PilatesFlow</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a href="dashboard.html" class="nav-link text-white me-3">Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <span class="nav-link text-white-50">Gestão de Turmas</span>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container pb-5">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h3 class="text-primary fw-bold mb-0">Grade Semanal</h3>
            <button class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#configModal">
                <i class="bi bi-gear-fill"></i> Configurar Horários
            </button>
        </div>

        <div class="grade-container p-3">
            <table class="table table-borderless mb-0 align-middle">
                <thead>
                    <tr class="text-center text-muted text-uppercase small">
                        <th class="sticky-col" style="min-width: 80px;">Horário</th>
                        <th>Seg</th>
                        <th>Ter</th>
                        <th>Qua</th>
                        <th>Qui</th>
                        <th>Sex</th>
                        <th>Sáb</th>
                        <th>Dom</th>
                    </tr>
                </thead>
                <tbody id="scheduleBody">
                    <!-- Preenchido via JS -->
                    <tr>
                        <td colspan="8" class="text-center p-5"><span class="spinner-border text-primary"></span></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="mt-3 d-flex gap-3 justify-content-center small text-muted">
            <div class="d-flex align-items-center gap-1"><span class="badge bg-success rounded-circle p-1"> </span> 0-3
                Vagas ocupadas</div>
            <div class="d-flex align-items-center gap-1"><span class="badge bg-warning rounded-circle p-1"> </span> 4-5
                Vagas ocupadas</div>
            <div class="d-flex align-items-center gap-1"><span class="badge bg-danger rounded-circle p-1"> </span>
                Lotado (6)</div>
        </div>
    </div>

    <!-- MODAL DETALHES DA TURMA -->
    <div class="modal fade" id="classDetailsModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow">
                <div class="modal-header bg-primary text-white border-0">
                    <h5 class="modal-title" id="classDetailsTitle">Turma</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-0">
                    <div class="p-3 bg-light border-bottom d-flex justify-content-between align-items-center">
                        <span class="fw-bold text-muted">Ocupação: <span id="classOccupancy">0/6</span></span>
                        <button class="btn btn-sm btn-success shadow-sm" id="btnAddStudentToClass">
                            <i class="bi bi-person-plus-fill"></i> Adicionar Aluno
                        </button>
                    </div>
                    <ul class="list-group list-group-flush" id="classStudentsList">
                        <!-- Lista de alunos aqui -->
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL ADICIONAR ALUNO -->
    <div class="modal fade" id="addStudentModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow">
                <div class="modal-header border-0">
                    <h5 class="modal-title">Adicionar Aluno à Turma</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="text" class="form-control mb-3" id="searchStudentInput" placeholder="Buscar aluno...">
                    <div class="list-group" id="availableStudentsList" style="max-height: 300px; overflow-y: auto;">
                        <!-- Lista filtrada -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL CONFIGURAR HORÁRIOS -->
    <div class="modal fade" id="configModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content border-0 shadow">
                <div class="modal-header border-0">
                    <h5 class="modal-title">Configurar Horários</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="input-group mb-3">
                        <input type="time" class="form-control" id="newTimeInput">
                        <button class="btn btn-primary" id="addTimeBtn">Adicionar</button>
                    </div>
                    <ul class="list-group" id="timesList">
                        <!-- Horários cadastrados -->
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast de Feedback -->
    <div class="toast-container position-fixed top-0 end-0 p-3">
        <div id="feedbackToast" class="toast align-items-center border-0 text-white" role="alert" aria-live="assertive"
            aria-atomic="true">
            <div class="d-flex">
                <div class="toast-body" id="feedbackMessage"></div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"
                    aria-label="Close"></button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="js/turmas.js"></script>
</body>

</html>